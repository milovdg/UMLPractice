<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1317px" preserveAspectRatio="none" style="width:2701px;height:1317px;background:#FFFFFF;" version="1.1" viewBox="0 0 2701 1317" width="2701px" zoomAndPan="magnify"><defs><filter height="300%" id="f58e51p86hkkn" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="146.2305" style="stroke:#A80036;stroke-width:1.0;" width="10" x="281" y="444.2773"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="166.4688" style="stroke:#A80036;stroke-width:1.0;" width="10" x="281" y="714.9063"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="149.0977" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1023" y="295.1797"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="110.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1023" y="1097.1719"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1438.5" y="510.1094"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1438.5" y="758.8438"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1960.5" y="295.1797"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="1027.5" x="983" y="256.9141"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="1299.5" x="221" y="471.8438"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="119.3359" style="stroke:#000000;stroke-width:2.0;" width="1299.5" x="221" y="676.6406"/><rect fill="#FFFFFF" height="73.0703" style="stroke:none;stroke-width:1.0;" width="1299.5" x="221" y="722.9063"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="1096.5" x="983" y="1169.4375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="63" x2="63" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="63" x2="63" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="63" x2="63" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="63" x2="63" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="63" x2="63" y1="917.375" y2="1232.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="131" x2="131" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="131" x2="131" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="131" x2="131" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="131" x2="131" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="131" x2="131" y1="917.375" y2="1232.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="198" x2="198" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="198" x2="198" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="198" x2="198" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="198" x2="198" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="198" x2="198" y1="917.375" y2="1232.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="286" x2="286" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="286" x2="286" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="286" x2="286" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="286" x2="286" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="286" x2="286" y1="917.375" y2="1232.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="450.5" x2="450.5" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="450.5" x2="450.5" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="450.5" x2="450.5" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="450.5" x2="450.5" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="450.5" x2="450.5" y1="917.375" y2="1232.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="964" x2="964" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="964" x2="964" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="964" x2="964" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="964" x2="964" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="964" x2="964" y1="917.375" y2="1232.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1028" x2="1028" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1028" x2="1028" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1028" x2="1028" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1028" x2="1028" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1028" x2="1028" y1="917.375" y2="1232.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1285.5" x2="1285.5" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1285.5" x2="1285.5" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1285.5" x2="1285.5" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1285.5" x2="1285.5" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1285.5" x2="1285.5" y1="917.375" y2="1232.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1342.5" x2="1342.5" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1342.5" x2="1342.5" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1342.5" x2="1342.5" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1342.5" x2="1342.5" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1342.5" x2="1342.5" y1="917.375" y2="1232.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1443.5" x2="1443.5" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1443.5" x2="1443.5" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1443.5" x2="1443.5" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1443.5" x2="1443.5" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1443.5" x2="1443.5" y1="917.375" y2="1232.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1576.5" x2="1576.5" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1576.5" x2="1576.5" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1576.5" x2="1576.5" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1576.5" x2="1576.5" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1576.5" x2="1576.5" y1="917.375" y2="1232.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1721.5" x2="1721.5" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1721.5" x2="1721.5" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1721.5" x2="1721.5" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1721.5" x2="1721.5" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1721.5" x2="1721.5" y1="917.375" y2="1232.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1865.5" x2="1865.5" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1865.5" x2="1865.5" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1865.5" x2="1865.5" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1865.5" x2="1865.5" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1865.5" x2="1865.5" y1="917.375" y2="1232.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1965.5" x2="1965.5" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1965.5" x2="1965.5" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1965.5" x2="1965.5" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1965.5" x2="1965.5" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1965.5" x2="1965.5" y1="917.375" y2="1232.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="2039.5" x2="2039.5" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="2039.5" x2="2039.5" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="2039.5" x2="2039.5" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="2039.5" x2="2039.5" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="2039.5" x2="2039.5" y1="917.375" y2="1232.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="2665.5" x2="2665.5" y1="196.7813" y2="598.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="2665.5" x2="2665.5" y1="598.5078" y2="626.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="2665.5" x2="2665.5" y1="626.5078" y2="889.375"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="2665.5" x2="2665.5" y1="889.375" y2="917.375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="2665.5" x2="2665.5" y1="917.375" y2="1232.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="39" y="193.4795">Client</text><ellipse cx="63.5" cy="123.4844" fill="#FEFECE" filter="url(#f58e51p86hkkn)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M63.5,131.4844 L63.5,158.4844 M50.5,139.4844 L76.5,139.4844 M63.5,158.4844 L50.5,173.4844 M63.5,158.4844 L76.5,173.4844 " fill="none" filter="url(#f58e51p86hkkn)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="39" y="1244.6982">Client</text><ellipse cx="63.5" cy="1258" fill="#FEFECE" filter="url(#f58e51p86hkkn)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M63.5,1266 L63.5,1293 M50.5,1274 L76.5,1274 M63.5,1293 L50.5,1308 M63.5,1293 L76.5,1308 " fill="none" filter="url(#f58e51p86hkkn)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="98" y="193.4795">Manager</text><ellipse cx="131.5" cy="123.4844" fill="#FEFECE" filter="url(#f58e51p86hkkn)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M131.5,131.4844 L131.5,158.4844 M118.5,139.4844 L144.5,139.4844 M131.5,158.4844 L118.5,173.4844 M131.5,158.4844 L144.5,173.4844 " fill="none" filter="url(#f58e51p86hkkn)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="98" y="1244.6982">Manager</text><ellipse cx="131.5" cy="1258" fill="#FEFECE" filter="url(#f58e51p86hkkn)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M131.5,1266 L131.5,1293 M118.5,1274 L144.5,1274 M131.5,1293 L118.5,1308 M131.5,1293 L144.5,1308 " fill="none" filter="url(#f58e51p86hkkn)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="42" x="175" y="161.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="182" y="181.4795">APP</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="42" x="175" y="1231.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="182" y="1251.6982">APP</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="106" x="231" y="161.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="238" y="181.4795">PaymentHub</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="106" x="231" y="1231.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="238" y="1251.6982">PaymentHub</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="55" x="421.5" y="161.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="428.5" y="181.4795">FxPay</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="55" x="421.5" y="1231.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="428.5" y="1251.6982">FxPay</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="34" x="945" y="161.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20" x="952" y="181.4795">AB</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="34" x="945" y="1231.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="20" x="952" y="1251.6982">AB</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="66" x="993" y="161.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="1000" y="181.4795">FxBank</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="66" x="993" y="1231.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="1000" y="1251.6982">FxBank</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="41" x="1263.5" y="161.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="1270.5" y="181.4795">UPP</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="41" x="1263.5" y="1231.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="1270.5" y="1251.6982">UPP</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="44" x="1318.5" y="161.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="1325.5" y="181.4795">AAA</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="44" x="1318.5" y="1231.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="1325.5" y="1251.6982">AAA</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="130" x="1376.5" y="145.1875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1425" y="165.1826">EPG</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="1383.5" y="181.4795">+other provider</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="130" x="1376.5" y="1231.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1425" y="1251.6982">EPG</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="1383.5" y="1267.9951">+other provider</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="108" x="1520.5" y="161.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="1527.5" y="181.4795">clientService</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="108" x="1520.5" y="1231.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94" x="1527.5" y="1251.6982">clientService</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="155" x="1642.5" y="161.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="1649.5" y="181.4795">clientProfileService</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="155" x="1642.5" y="1231.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="1649.5" y="1251.6982">clientProfileService</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="105" x="1811.5" y="161.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="1818.5" y="181.4795">transliterate</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="105" x="1811.5" y="1231.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="1818.5" y="1251.6982">transliterate</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="66" x="1930.5" y="161.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="1937.5" y="181.4795">dealing</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="66" x="1930.5" y="1231.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="1937.5" y="1251.6982">dealing</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="55" x="2010.5" y="161.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="2017.5" y="181.4795">Kafka</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="55" x="2010.5" y="1231.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="2017.5" y="1251.6982">Kafka</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="43" x="2642.5" y="161.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="2649.5" y="181.4795">EPG</text><rect fill="#FEFECE" filter="url(#f58e51p86hkkn)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="43" x="2642.5" y="1231.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="2649.5" y="1251.6982">EPG</text><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="146.2305" style="stroke:#A80036;stroke-width:1.0;" width="10" x="281" y="444.2773"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="166.4688" style="stroke:#A80036;stroke-width:1.0;" width="10" x="281" y="714.9063"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="149.0977" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1023" y="295.1797"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="110.5313" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1023" y="1097.1719"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1438.5" y="510.1094"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1438.5" y="758.8438"/><rect fill="#FFFFFF" filter="url(#f58e51p86hkkn)" height="29.1328" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1960.5" y="295.1797"/><rect fill="#EEEEEE" filter="url(#f58e51p86hkkn)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2694.5" x="0" y="227.3477"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2694.5" y1="227.3477" y2="227.3477"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2694.5" y1="230.3477" y2="230.3477"/><rect fill="#EEEEEE" filter="url(#f58e51p86hkkn)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="231" x="1231.75" y="216.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="212" x="1237.75" y="232.8481">Process withdrawal request</text><path d="M983,256.9141 L1061,256.9141 L1061,263.9141 L1051,273.9141 L983,273.9141 L983,256.9141 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="1027.5" x="983" y="256.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="998" y="269.981">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="63" x="1076" y="269.1245">[10 tries]</text><polygon fill="#A80036" points="1948.5,291.1797,1958.5,295.1797,1948.5,299.1797,1952.5,295.1797" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1033" x2="1954.5" y1="295.1797" y2="295.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1040" y="290.1138">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338" x="1053" y="290.1138">changeBalance with operation PAYMENT_OPERATION</text><polygon fill="#A80036" points="1044,320.3125,1034,324.3125,1044,328.3125,1040,324.3125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1038" x2="1964.5" y1="324.3125" y2="324.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1050" y="319.2466">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="1063" y="319.2466">operationId and operationDate</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1033" x2="1075" y1="360.4453" y2="360.4453"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1075" x2="1075" y1="360.4453" y2="373.4453"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1034" x2="1075" y1="373.4453" y2="373.4453"/><polygon fill="#A80036" points="1044,369.4453,1034,373.4453,1044,377.4453,1040,373.4453" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="8" x="1040" y="355.3794">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="1052" y="355.3794">set balance from dealing responce</text><polygon fill="#A80036" points="2028,398.5781,2038,402.5781,2028,406.5781,2032,402.5781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1033" x2="2034" y1="402.5781" y2="402.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="1040" y="397.5122">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="1053" y="397.5122">withdrawal:send</text><line style="stroke:#A80036;stroke-width:1.0;" x1="291" x2="301" y1="444.2773" y2="440.2773"/><line style="stroke:#A80036;stroke-width:1.0;" x1="291" x2="301" y1="444.2773" y2="448.2773"/><line style="stroke:#A80036;stroke-width:1.0;" x1="291" x2="1027" y1="444.2773" y2="444.2773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="308" y="439.2114">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="321" y="439.2114">process withdrawal transaction</text><path d="M5,415.5781 L5,455.5781 L272,455.5781 L272,425.5781 L262,415.5781 L5,415.5781 " fill="#FBFB77" filter="url(#f58e51p86hkkn)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M262,415.5781 L262,425.5781 L272,425.5781 L262,415.5781 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246" x="11" y="432.645">at the moment 1st call is synchronous</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="11" y="447.7778">other call by queue</text><path d="M221,471.8438 L299,471.8438 L299,478.8438 L289,488.8438 L221,488.8438 L221,471.8438 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="75.3984" style="stroke:#000000;stroke-width:2.0;" width="1299.5" x="221" y="471.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="236" y="484.9106">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="196" x="314" y="484.0542">[10 repeats if network error]</text><polygon fill="#A80036" points="1426.5,506.1094,1436.5,510.1094,1426.5,514.1094,1430.5,510.1094" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="291" x2="1432.5" y1="510.1094" y2="510.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="298" y="505.0435">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230" x="311" y="505.0435">request for WD / approve WD (EPG)</text><polygon fill="#A80036" points="302,535.2422,292,539.2422,302,543.2422,298,539.2422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="296" x2="1442.5" y1="539.2422" y2="539.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="308" y="534.1763">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="17" x="321" y="534.1763">Ok</text><polygon fill="#A80036" points="1016,586.5078,1026,590.5078,1016,594.5078,1020,590.5078" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="286" x2="1022" y1="590.5078" y2="590.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="293" y="577.8755">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="306" y="570.3091">update withdawal status ps_fxpay_out</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="306" y="585.4419">successed/failed/incomplete</text><rect fill="#EEEEEE" filter="url(#f58e51p86hkkn)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2694.5" x="0" y="647.0742"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2694.5" y1="647.0742" y2="647.0742"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2694.5" y1="650.0742" y2="650.0742"/><rect fill="#EEEEEE" filter="url(#f58e51p86hkkn)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="270" x="1212.25" y="636.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="256" x="1218.25" y="652.5747">Update operation status from PS</text><path d="M221,676.6406 L287,676.6406 L287,683.6406 L277,693.6406 L221,693.6406 L221,676.6406 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="119.3359" style="stroke:#000000;stroke-width:2.0;" width="1299.5" x="221" y="676.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="236" y="689.7075">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="118" x="302" y="688.8511">[kafka / webhook]</text><polygon fill="#A80036" points="302,710.9063,292,714.9063,302,718.9063,298,714.9063" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="296" x2="1442.5" y1="714.9063" y2="714.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="308" y="709.8403">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="321" y="709.8403">send new operation status</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="221" x2="1520.5" y1="723.9063" y2="723.9063"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="110" x="226" y="734.1167">[request status]</text><polygon fill="#A80036" points="1426.5,754.8438,1436.5,758.8438,1426.5,762.8438,1430.5,758.8438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="291" x2="1432.5" y1="758.8438" y2="758.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="298" y="753.7778">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="321" y="753.7778">request payment status</text><polygon fill="#A80036" points="302,783.9766,292,787.9766,302,791.9766,298,787.9766" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="296" x2="1442.5" y1="787.9766" y2="787.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="308" y="782.9106">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="330" y="782.9106">payment status with details</text><line style="stroke:#A80036;stroke-width:1.0;" x1="291" x2="333" y1="824.1094" y2="824.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="333" x2="333" y1="824.1094" y2="837.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="292" x2="333" y1="837.1094" y2="837.1094"/><polygon fill="#A80036" points="302,833.1094,292,837.1094,302,841.1094,298,837.1094" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="298" y="819.0435">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119" x="320" y="819.0435">update withdrawal</text><polygon fill="#A80036" points="1016,877.375,1026,881.375,1016,885.375,1020,881.375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="286" x2="1022" y1="881.375" y2="881.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="293" y="868.7427">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271" x="314" y="861.1763">update withdawal status os_ps_fxpay_out</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="314" y="876.3091">successed/failed</text><rect fill="#EEEEEE" filter="url(#f58e51p86hkkn)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2694.5" x="0" y="937.9414"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2694.5" y1="937.9414" y2="937.9414"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2694.5" y1="940.9414" y2="940.9414"/><rect fill="#EEEEEE" filter="url(#f58e51p86hkkn)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="298" x="1198.25" y="927.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="279" x="1204.25" y="943.4419">Status of withdrawal entity changed</text><polygon fill="#A80036" points="2051,977.6406,2041,981.6406,2051,985.6406,2047,981.6406" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="2045" x2="2665" y1="981.6406" y2="981.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="2057" y="976.5747">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="580" x="2079" y="976.5747">(as crypto push from crypto_adapter) - Transfer event about successful (failed) withdawal</text><polygon fill="#A80036" points="462,1006.7734,452,1010.7734,462,1014.7734,458,1010.7734" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="456" x2="2039" y1="1010.7734" y2="1010.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="468" y="1005.7075">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="580" x="490" y="1005.7075">(as crypto push from crypto_adapter) - Transfer event about successful (failed) withdawal</text><line style="stroke:#A80036;stroke-width:1.0;" x1="451" x2="493" y1="1039.9063" y2="1039.9063"/><line style="stroke:#A80036;stroke-width:1.0;" x1="493" x2="493" y1="1039.9063" y2="1052.9063"/><line style="stroke:#A80036;stroke-width:1.0;" x1="452" x2="493" y1="1052.9063" y2="1052.9063"/><polygon fill="#A80036" points="462,1048.9063,452,1052.9063,462,1056.9063,458,1052.9063" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="458" y="1034.8403">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="477" x="480" y="1034.8403">by provided from crypto_adapter payment_id seek withdrawal transaction</text><polygon fill="#A80036" points="1011,1093.1719,1021,1097.1719,1011,1101.1719,1015,1097.1719" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="451" x2="1017" y1="1097.1719" y2="1097.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="458" y="1084.5396">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249" x="480" y="1076.9731">update withdawal status ps_fxpay_out</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="480" y="1092.106">successed/failed</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1033" x2="1075" y1="1141.4375" y2="1141.4375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1075" x2="1075" y1="1141.4375" y2="1154.4375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1034" x2="1075" y1="1154.4375" y2="1154.4375"/><polygon fill="#A80036" points="1044,1150.4375,1034,1154.4375,1044,1158.4375,1040,1154.4375" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1040" y="1128.8052">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="1062" y="1121.2388">change status for withdraw</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="1062" y="1136.3716">successed/failed/incomplete</text><path d="M983,1169.4375 L1055,1169.4375 L1055,1176.4375 L1045,1186.4375 L983,1186.4375 L983,1169.4375 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="1096.5" x="983" y="1169.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27" x="998" y="1182.5044">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="183" x="1070" y="1181.6479">[if status successed/failed]</text><polygon fill="#A80036" points="2028,1203.7031,2038,1207.7031,2028,1211.7031,2032,1207.7031" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1028" x2="2034" y1="1207.7031" y2="1207.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="1035" y="1202.6372">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="296" x="1057" y="1202.6372">push event withdraw: succeeded/failed status</text><rect fill="#DDDDDD" height="91.4844" rx="5" ry="5" style="stroke:#000000;stroke-width:1.0;" width="352" x="8" y="13"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="340" x="14" y="30.9951">Common withdrawal sequence diagram except:</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="14" y="47.292">- Antifraud details</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="232" x="14" y="63.5889">- Create requisites for bank, cup</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="267" x="14" y="79.8857">- Approve CUP requisites by manager</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="194" x="14" y="96.1826">- Export of bank payments</text><!--MD5=[ac42643a19d46ca23d640eb7fc3dc664]
@startuml
scale max 8192 height
autonumber
legend top left
  Common withdrawal sequence diagram except:
  - Antifraud details
  - Create requisites for bank, cup
  - Approve CUP requisites by manager
  - Export of bank payments
end legend

actor Client
actor Manager
participant APP
participant PaymentHub
participant FxPay
participant AB
participant FxBank
participant UPP
participant AAA
participant PS as "EPG \n+other provider"
participant clientService
participant clientProfileService
participant transliterateService as "transliterate"
participant dealing
participant Kafka

== Process withdrawal request ==
loop 10 tries
    FxBank -> dealing : changeBalance with operation PAYMENT_OPERATION
    activate FxBank
    activate dealing
    dealing - -> FxBank : operationId and operationDate
    deactivate dealing
end
FxBank -> FxBank : set balance from dealing responce
FxBank  -> Kafka : withdrawal:send
FxBank ->> PaymentHub : process withdrawal transaction
deactivate FxBank
activate PaymentHub
note left
at the moment 1st call is synchronous
other call by queue
end note
loop 10 repeats if network error
    PaymentHub -> PS : request for WD / approve WD (EPG)
    activate PS
    PS -> PaymentHub : Ok
    deactivate PS
end
PaymentHub - -> FxBank : update withdawal status ps_fxpay_out\nsuccessed/failed/incomplete
deactivate PaymentHub


...
== Update operation status from PS==
alt kafka / webhook
PS -> PaymentHub : send new operation status
activate PaymentHub
else request status
PaymentHub -> PS: request payment status
activate PS
PS - -> PaymentHub: payment status with details
deactivate PS
end
activate PaymentHub
PaymentHub -> PaymentHub : update withdrawal
PaymentHub - -> FxBank : update withdawal status os_ps_fxpay_out\nsuccessed/failed
deactivate PaymentHub


...
== Status of withdrawal entity changed ==
EPG - -> Kafka: (as crypto push from crypto_adapter) - Transfer event about successful (failed) withdawal
Kafka - -> FxPay: (as crypto push from crypto_adapter) - Transfer event about successful (failed) withdawal
FxPay -> FxPay: by provided from crypto_adapter payment_id seek withdrawal transaction
FxPay - -> FxBank : update withdawal status ps_fxpay_out\nsuccessed/failed
activate FxBank
FxBank -> FxBank: change status for withdraw \nsuccessed/failed/incomplete
opt if status successed/failed
FxBank -> Kafka : push event withdraw: succeeded/failed status
deactivate FxBank
end
@enduml

PlantUML version 1.2021.10beta5(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>